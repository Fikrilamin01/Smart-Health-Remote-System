<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <title>Sensor Dashboard</title>
</head>
<body>

<div id="main">

<div class="container shadow p-3 mb-5  bg-primary bg-opacity-25 rounded"
     style="position: relative; top: 50px; width: 60%;">
    <div class="container overflow-hidden">


            <h1 class="d-flex justify-content-start">Patient's Health Condition</h1>

            <div class="container mt-5 ">

                <div id="chartContainer" style="height: 400px; width: 100%;"></div>
                <script th:inline="javascript">
                    var  ecg= /*[[${ecgReading}]]*/ 100;
                    var xAxisStripLinesArray = [];
                    var yAxisStripLinesArray = [];
                    var dps = [];
                    var dataPointsArray = ecg;


                    var chart = new CanvasJS.Chart("chartContainer",
                        {
                            title:{
                                text:"ECG Report",
                            },
                            axisY:{
                                stripLines:yAxisStripLinesArray,
                                gridThickness: 2,
                                gridColor:"#DC74A5",
                                lineColor:"#DC74A5",
                                tickColor:"#DC74A5",
                                labelFontColor:"#DC74A5",
                            },
                            axisX:{
                                stripLines:xAxisStripLinesArray,
                                gridThickness: 2,
                                gridColor:"#DC74A5",
                                lineColor:"#DC74A5",
                                tickColor:"#DC74A5",
                                labelFontColor:"#DC74A5",
                            },
                            data: [
                                {
                                    type: "spline",
                                    color:"black",
                                    dataPoints: dps
                                }
                            ]
                        });

                    addDataPointsAndStripLines();
                    chart.render();

                    function addDataPointsAndStripLines(){
                        //dataPoints
                        for(var i=0; i<dataPointsArray.length;i++){
                            dps.push({y: dataPointsArray[i]});
                        }
                        //StripLines
                        for(var i=0;i<3000;i=i+100){
                            if(i%1000 != 0)
                                yAxisStripLinesArray.push({value:i,thickness:0.7, color:"#DC74A5"});
                        }
                        for(var i=0;i<1400;i=i+20){
                            if(i%200 != 0)
                                xAxisStripLinesArray.push({value:i,thickness:0.7, color:"#DC74A5"});
                        }
                    }
                </script>



                <table class="table table-bordered border border-dark">
                    <thead>
                    <tr>
                        <th scope="col">Body Temperature(Celsius)</th>
                        <th scope="col">Oxygen Saturation(SpO2)%</th>
                        <th scope="col">Date & Time</th>
                    </tr>
                    </thead>
                    <tbody class="tbody">
                    <tr th:each="sensorData: ${sensorDataList}">
                        <td th:text="${sensorData.bodyTemperature}">-</td>
                        <td th:text="${sensorData.oxygenReading}">-</td>
                        <td th:text="${sensorData.timestamp}">-</td>
                    </tr>

                    </tbody>
                </table>
            </div>



    </div>

</div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>


</body>
</html>